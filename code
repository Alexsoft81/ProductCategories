CREATE TABLE [dbo].[Categories] (
    [Id] INT NOT NULL,
    [CategoryName] NVARCHAR (50) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY CLUSTERED ([Id] ASC)
);

CREATE TABLE [dbo].[Products] (
    [Id] INT NOT NULL,
    [ProductName] NVARCHAR (50) NOT NULL,
    CONSTRAINT [PK_Teams] PRIMARY KEY CLUSTERED ([Id] ASC)
);

CREATE TABLE [dbo].[CategoryProducts] (
    [CategoryId] INT NOT NULL,
    [ProductId] INT NOT NULL,
    CONSTRAINT [PK_CategoryProducts] PRIMARY KEY CLUSTERED ([CategoryId] ASC, [ProductId] ASC),
    CONSTRAINT [FK_CategoryProducts_Categories] FOREIGN KEY ([CategoryId]) REFERENCES [dbo].[Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_CategoryProducts_Products] FOREIGN KEY ([ProductId]) REFERENCES [dbo].[Products] ([Id]) ON DELETE CASCADE
);

SELECT [Products].ProductName, [Categories].CategoryName
FROM [Products] 
LEFT JOIN 
([CategoryProducts] JOIN [Categories] ON [CategoryProducts].CategoryId = [Categories].Id)
ON [Products].Id = [CategoryProducts].ProductId;
